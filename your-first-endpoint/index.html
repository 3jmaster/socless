



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://twilio-labs.github.io/socless/your-first-endpoint/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Your First Endpoint - SOCless Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#your-first-endpoint" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://twilio-labs.github.io/socless/" title="SOCless Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SOCless Docs
            </span>
            <span class="md-header-nav__topic">
              
                Your First Endpoint
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://twilio-labs.github.io/socless/" title="SOCless Docs" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    SOCless Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deploying-socless/" title="Deploying Socless" class="md-nav__link">
      Deploying Socless
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../key-concepts-and-terms/" title="Key Concepts and Terms" class="md-nav__link">
      Key Concepts and Terms
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1" checked>
    
    <label class="md-nav__link" for="nav-4-1">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-started/" title="Getting Started Tutorial" class="md-nav__link">
      Getting Started Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-first-integration-geolocating-an-ip/" title="Your First Integration: Geolocating an IP" class="md-nav__link">
      Your First Integration: Geolocating an IP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-second-integration-sending-a-slack-message/" title="Your Second Integration: Sending a Slack Message" class="md-nav__link">
      Your Second Integration: Sending a Slack Message
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-first-playbook/" title="Your First Playbook" class="md-nav__link">
      Your First Playbook
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Your First Endpoint" class="md-nav__link md-nav__link--active">
      Your First Endpoint
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../test-your-first-playbook/" title="Test Your First Playbook" class="md-nav__link">
      Test Your First Playbook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Interacting With Humans via Slack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Interacting With Humans via Slack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial-interacting-with-humans-via-slack/" title="Interacting With Humans via Slack" class="md-nav__link">
      Interacting With Humans via Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy-socless-slack/" title="Deploy Socless Slack" class="md-nav__link">
      Deploy Socless Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../human-interaction-overview/" title="Human Interaction Overview" class="md-nav__link">
      Human Interaction Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prompting-a-user-for-confirmation/" title="Prompt a User for Confirmation" class="md-nav__link">
      Prompt a User for Confirmation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../making-choices-in-playbooks/" title="Making Choices in Playbooks" class="md-nav__link">
      Making Choices in Playbooks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../collect-information-using-a-slack-dialog/" title="Collect Information Using a Slack Dialog" class="md-nav__link">
      Collect Information Using a Slack Dialog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reference Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../socless-and-serverless/" title="Socless & Serverless" class="md-nav__link">
      Socless & Serverless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../parameter-references-and-template-variables/" title="Parameter References & Template Variables" class="md-nav__link">
      Parameter References & Template Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../human-interaction-architecture/" title="Human Interaction Architecture" class="md-nav__link">
      Human Interaction Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../state-management-in-socless/" title="State Management in SOCless" class="md-nav__link">
      State Management in SOCless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../socless-vs-stock-stepfunctions/" title="SOCless vs Stock AWS Step Functions" class="md-nav__link">
      SOCless vs Stock AWS Step Functions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      SOCless Betterments List
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        SOCless Betterments List
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../betterments-list/" title="Betterment List Overview" class="md-nav__link">
      Betterment List Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../betterment-template/" title="Betterment Template" class="md-nav__link">
      Betterment Template
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faqs/" title="FAQs" class="md-nav__link">
      FAQs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About SOCless" class="md-nav__link">
      About SOCless
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="your-first-endpoint">Your First Endpoint</h1>
<p>Socless uses Event Endpoints to receive event/alert data from external systems and trigger playbooks.</p>
<p>At their core, Event Endpoints are simply AWS Lambda functions that invoke the <code>create_events</code> function from the <code>socless</code> Python library with the information necessary to register the event within Socless and trigger the appropriate playbook. As such, the bare-bones, psuedo-code implementation for any Socless Event Endpoint looks like this:</p>
<pre><code>from socless import create_events

def lambda_handler(event, context):
    # Populate event_details object with approriate fields
    event_details = {
        'event_type': '...', # event name
        'playbook': '...',  # playbook name
        'details': [{'...'},{'...'}] # alert findings
    }
    # Invoke create_events function with event_details
    create_events(event_details, context)
    return {&quot;statusCode&quot;: 200}
</code></pre>

<p>The <code>create_events</code> function takes two parameters: <code>event_details</code> and <code>context</code>.</p>
<p><code>context</code> is the AWS Lambda context which all Lambda functions receive when they are executed by AWS. It’s passed to the create_events function without any modification.</p>
<p><code>event_details</code> is a dictionary constructed by the developer of the Event Endpoint that must contain the below key-value pairs:</p>
<table>
<thead>
<tr>
<th><em>Key</em></th>
<th><em>Type</em></th>
<th><em>Description</em></th>
<th><em>Required?</em></th>
<th><em>Example Value</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>event_type</td>
<td>string</td>
<td>The unique event name</td>
<td>Yes</td>
<td>Anomalous Login IP Detected</td>
</tr>
<tr>
<td>details</td>
<td>list of dicts</td>
<td>List of dictionaries containing aggregated findings for the event type</td>
<td>Yes</td>
<td>[{"username": "bruce.wayne","ip": "113.63.125.3"}]</td>
</tr>
<tr>
<td>playbook</td>
<td>string</td>
<td>The Playbook to execute for the event</td>
<td>Yes</td>
<td>InvestigateLogin</td>
</tr>
</tbody>
</table>
<p>For our tutorial, all the values needed to populate the <code>event_details</code> dictionary are conveniently contained in the alert payload our detection system will send.</p>
<p>So the implementation for our tutorial endpoint will look like this:</p>
<pre><code>from socless import create_events
import json

def lambda_handler(event, context):
    alert_payload  = json.loads(event['body'])
    event_details = {
        'event_type': alert_payload['alert_name'],
        'playbook': alert_payload['response_plan'],
        'details': alert_payload['details']
    }
    try:
        create_events(event_details, context)
    except Exception as e:
        return {&quot;statusCode&quot;: 400, &quot;body&quot;: f&quot;{e}&quot;}
    return {&quot;statusCode&quot;: 200}
</code></pre>

<p>Include this implementation in the <code>lambda_function.py</code> file in the <code>tutorial_endpoint</code> folder. Note that the current implementation does not include an authentication mechanism to protect our endpoint. Authentication for endpoints will be discussed in the Event Endpoints reference documentation here. For now, we’ll keep our endpoint simple and include authentication later in our tutorial.</p>
<p>With the logic for our Event Endpoint implemented, we’re ready to configure it for deployment</p>
<h1 id="configuring-our-event-endpoint-for-deployment">Configuring our Event Endpoint for Deployment</h1>
<p>Much like Socless’ core infrastructure, Event Endpoints are deployed as Serverless Framework applications. Since we created our <code>socless-tutorial</code> folder using the <code>socless-integrations-template</code>, it is already pre-configured with much of the information we need to deploy our Event Endpoint (the current pre-configurations will be explained in the <code>socless-integrations-template</code> reference documentation here).</p>
<p>All we need do now is add configurations for the <code>tutorial_endpoint</code> function we just created.
Open the <code>serverless.yml</code> file contained within our <code>socless-tutorial</code> folder. This file is where configurations for our <code>socless-tutorial</code> Serverless application lives. <em>At the bottom of the file</em>, let’s configure a lambda function that:</p>
<ul>
<li>is reference-able in our config as <code>TutorialEndpoint</code></li>
<li>is named <code>_socless_tutorial_endpoint</code></li>
<li>has its entry point (handler) at <code>lambda_function.lambda_handler</code></li>
<li>has the description: “Receives alerts from our tutorial detection system”</li>
<li>creates its source package from the contents of the <code>functions/tutorial_endpoint</code> folder of our <code>socless-tutorial</code> folder</li>
<li>is triggered by an http POST request to the <code>/endpoints/tutorial</code> path of Socless’ API endpoint</li>
</ul>
<p>Here’s what that configuration looks like:</p>
<pre><code>  TutorialEndpoint:
    name: _socless_tutorial_endpoint
    handler: lambda_function.lambda_handler
    description: Receives alerts from our tutorial detection system
    package:
      include:
        - functions/tutorial_endpoint
    events:
      - http:
          path: /tutorial
          method: post
</code></pre>

<p>We are now ready to deploy and test our endpoint.</p>
<h1 id="deploy-the-endpoint">Deploy The Endpoint</h1>
<p>Since we’re still in the development phase, we’ll only deploy the event endpoint to our Socless dev environment. Do so by running the below command</p>
<pre><code>npm run dev
</code></pre>

<p>Once the deployment is successful, you will find a URL that ends in <code>/tutorial</code> in the <em>Service Information</em> section. This is the URL for the endpoint we just deployed. It’s where our tutorial detection system will send our alert payload. Keep it handy. We'll need it to <a href="../test-your-first-playbook/">test the playbook</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../your-first-playbook/" title="Your First Playbook" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Your First Playbook
              </span>
            </div>
          </a>
        
        
          <a href="../test-your-first-playbook/" title="Test Your First Playbook" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Test Your First Playbook
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>