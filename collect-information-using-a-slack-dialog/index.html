



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://twilio-labs.github.io/socless/collect-information-using-a-slack-dialog/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Collect Information Using a Slack Dialog - SOCless Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://twilio-labs.github.io/socless/" title="SOCless Docs" aria-label="SOCless Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SOCless Docs
            </span>
            <span class="md-header-nav__topic">
              
                Collect Information Using a Slack Dialog
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://twilio-labs.github.io/socless/" title="SOCless Docs" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    SOCless Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deploying-socless/" title="Deploying Socless" class="md-nav__link">
      Deploying Socless
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../key-concepts-and-terms/" title="Key Concepts and Terms" class="md-nav__link">
      Key Concepts and Terms
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-started/" title="Getting Started Tutorial" class="md-nav__link">
      Getting Started Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-first-integration-geolocating-an-ip/" title="Your First Integration: Geolocating an IP" class="md-nav__link">
      Your First Integration: Geolocating an IP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-second-integration-sending-a-slack-message/" title="Your Second Integration: Sending a Slack Message" class="md-nav__link">
      Your Second Integration: Sending a Slack Message
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-first-playbook/" title="Your First Playbook" class="md-nav__link">
      Your First Playbook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../your-first-endpoint/" title="Your First Endpoint" class="md-nav__link">
      Your First Endpoint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../test-your-first-playbook/" title="Test Your First Playbook" class="md-nav__link">
      Test Your First Playbook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Interacting With Humans via Slack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Interacting With Humans via Slack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial-interacting-with-humans-via-slack/" title="Interacting With Humans via Slack" class="md-nav__link">
      Interacting With Humans via Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy-socless-slack/" title="Deploy Socless Slack" class="md-nav__link">
      Deploy Socless Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../human-interaction-overview/" title="Human Interaction Overview" class="md-nav__link">
      Human Interaction Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prompting-a-user-for-confirmation/" title="Prompt a User for Confirmation" class="md-nav__link">
      Prompt a User for Confirmation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../making-choices-in-playbooks/" title="Making Choices in Playbooks" class="md-nav__link">
      Making Choices in Playbooks
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
    <a href="./" title="Collect Information Using a Slack Dialog" class="md-nav__link md-nav__link--active">
      Collect Information Using a Slack Dialog
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reference Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../socless-and-serverless/" title="Socless & Serverless" class="md-nav__link">
      Socless & Serverless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../parameter-references-and-template-variables/" title="Parameter References & Template Variables" class="md-nav__link">
      Parameter References & Template Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../human-interaction-architecture/" title="Human Interaction Architecture" class="md-nav__link">
      Human Interaction Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../state-management-in-socless/" title="State Management in SOCless" class="md-nav__link">
      State Management in SOCless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../socless-vs-stock-stepfunctions/" title="SOCless vs Stock AWS Step Functions" class="md-nav__link">
      SOCless vs Stock AWS Step Functions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      SOCless Betterments List
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        SOCless Betterments List
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../betterments-list/" title="Betterment List Overview" class="md-nav__link">
      Betterment List Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../betterment-template/" title="Betterment Template" class="md-nav__link">
      Betterment Template
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faqs/" title="FAQs" class="md-nav__link">
      FAQs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About SOCless" class="md-nav__link">
      About SOCless
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Collect Information Using a Slack Dialog</h1>
                
                <p>For the final part of our tutorial, let's learn to trigger a <a href="https://api.slack.com/dialogs">Slack Dialog</a>. Slack Dialogs allow humans to provide detailed information to a playbook.</p>
<p>The Socless Slack integration for sending dialogs is called SendDialog. Like PromptForConfirmation, it relies on Socless' human interaction workflow as well, which, as we learned, means it needs to be followed by an AwaitMessageResponseActivity state. In addition, Slack Dialogs have lifecycle requirements that we'll learn about in this tutorial.</p>
<p>The lifecycle for working with a Slack Dialog on any platform is:</p>
<ul>
<li>Slack User responds to an interactive message (e.g. button press) or uses a slash command. This generates a trigger_id that is valid for 3 seconds</li>
<li>Backend system uses trigger_id to open a Slack Dialog for the user. A Slack Dialog can't be opened without the trigger_id that is generated when a user interacts with an interactive message or slash command</li>
<li>User either submits or cancels the dialog. This sends either a <code>dialog_submission</code> or <code>dialog_cancellation</code> event back to the backend system.</li>
<li>Backend system handles either dialog_submission or dialog_cancellation event</li>
</ul>
<p>When Slack Dialogs are implemented in Socless, the "Backend system" described above is the Socless Playbook. Thus, to use a Slack Dialog in Socless, you need to:</p>
<ul>
<li>Send an Interactive Message using PromptForConfirmaton, or request a slash command be run using PromptForResponse Socless Slack Integrations</li>
<li>Pass the trigger_id that is included in the user's response by Slack to the Socless Slack SendDialog integration, to open the dialog</li>
<li>Wait for the Users' Dialog Response</li>
<li>Use a Choice State to check if the user submitted or canceled the dialog</li>
<li>Handle each response as appropriate.</li>
</ul>
<p>Let's learn how to implement this by modifying our InvestigateLogin playbook to request additional information -- via a dialog -- when a user specifies that they did <strong>NOT</strong> perform the login we prompted them to confirm.</p>
<p>Start by reconfiguring the <code>Did_User_Login</code> Choice state to transition <code>Request_More_Info</code> instead of <code>Reassure_User</code> when a user responds "no" to our prompt for login verification. Don't delete the <code>Reassure_User</code> state, however. We'll still need to reassure the user that help is one the way after we collect more information.</p>
<p>Next, Configure <code>Request_More_Info</code> to use our SendDialog integration to request more information as shown below. You can add the configuration anywhere in the States object. Order of states in the States object doesn't matter. All that matters is that transitions are configured correctly.</p>
<pre><code>    &quot;Request_More_Info&quot;: {
      &quot;Type&quot;: &quot;Task&quot;,
      &quot;Resource&quot;: &quot;${{self:custom.slack.SendDialog}}&quot;,
      &quot;Parameters&quot;: {
        &quot;receiver&quot;: &quot;Await_Additional_Info&quot;,
        &quot;trigger_id&quot;: &quot;$.results.Await_User_Verification.trigger_id&quot;,
        &quot;title&quot;: &quot;Tell Us More&quot;,
        &quot;elements&quot;: [
          {
            &quot;label&quot;: &quot;Where and when was your last login to your account?&quot;,
            &quot;name&quot;: &quot;additional_info&quot;,
            &quot;optional&quot;: false,
            &quot;placeholder&quot;: &quot;My last log in was at ... from ....&quot;,
            &quot;type&quot;: &quot;text&quot;
          }
        ]
      },
      &quot;Next&quot;: &quot;Await_Additional_Info&quot;
    },
    &quot;Await_Additional_Info&quot;: {
      &quot;Type&quot;: &quot;Task&quot;,
      &quot;Resource&quot;: &quot;${{self:custom.socless.AwaitMessageResponseActivity}}&quot;,
      &quot;Next&quot;: &quot;Did_User_Submit_Dialog&quot;
    }
</code></pre>

<p>SendDialog is configured to follow the Human Interaction Workflow. Pay attention to the parameters passed, specifically trigger_id and elements. trigger_id is sourced from Await_User_Verification -- the state that receives our user's response to the button press. <code>elements</code> is built according to Slack's documentation on <a href="https://api.slack.com/dialogs#elements">authoring Dialog elements</a>. Be sure to review that documentation to familiarize yourself with all available Slack Dialog elements. Finally, the state transitions to Await_Additional_Info which will receive the response from the dialog.</p>
<p>The above configuration handles sending a dialog and receiving the response. However, since the response may either be a submission or cancellation, we need a choice state to examine the response and guide our execution. That's what <code>Did_User_Submit_Dialog</code> will do. Let's configure that choice state as shown below:</p>
<pre><code>&quot;Did_User_Submit_Dialog&quot;: {
      &quot;Type&quot;: &quot;Choice&quot;,
      &quot;Choices&quot;: [
        {
          &quot;Variable&quot;: &quot;$.results.Await_Additional_Info.type&quot;,
          &quot;StringEquals&quot;: &quot;dialog_submission&quot;,
          &quot;Next&quot;: &quot;Reassure_User&quot;
        },
        {
          &quot;Variable&quot;: &quot;$.results.Await_Additional_Info.type&quot;,
          &quot;StringEquals&quot;: &quot;dialog_cancellation&quot;,
          &quot;Next&quot;: &quot;Update_Bat_Signals_Channel&quot;
        }
      ]
    }
</code></pre>

<p>The state checks the data at <code>$.results.Await_Additional_Info.type</code> to determine what action was taken on the dialog i.e. dialog_submission or dialog_cancellation. If the dialog was submitted, it transitions to <code>Reassure_User</code> which is already configured in our playbook. If the dialog was cancelled, it transitions to <code>Update_Bat_Signals_Channel</code>. Let's configure that state as shown below:</p>
<pre><code>&quot;Update_Bat_Signals_Channel&quot;: {
      &quot;Type&quot;: &quot;Task&quot;,
      &quot;Resource&quot;: &quot;${{self:custom.slack.SendMessage}}&quot;,
      &quot;Parameters&quot;: {
        &quot;target&quot;: &quot;bat-signals&quot;,
        &quot;target_type&quot;: &quot;channel&quot;,
        &quot;message_template&quot;: &quot;User, {context.artifacts.event.details.username}, reported that they did not log into their account but also failed to provide additional details via the dialog. Please investigate.&quot;
      },
      &quot;End&quot;: true
    }
</code></pre>

<p>The configuration uses the Socless Slack SendMessage integration to update the bat-signals channel that the dialog requesting additional information wasn't submitted. It then ends the playbook execution.</p>
<p>Deploy the playbook and execute our test case located in the investigate_login folder. Run through all the possible flows of the playbook to get an idea of the user experience. You'll probably identify a number of places where the experience can be improved (e.g. providing a feedback message to the user after they cancel the dialog). Feel free to tackle these improvements to practice what you've learned.</p>
<p>With that addition, you've successfully written a playbook that interacts with a human using message buttons and dialogs! Congratulations 🍾 🍾</p>
<p>That's all for this tutorial series.</p>
<p>In future tutorials, we'll cover:</p>
<ul>
<li>Executing Lambda Integrations in Parallel,</li>
<li>Using Pass States to label branches on your playbook to improve legibility</li>
<li>Leveraging Socless' Deduplication Mechanism to Handle Duplicate Events</li>
</ul>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../making-choices-in-playbooks/" title="Making Choices in Playbooks" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Making Choices in Playbooks
              </span>
            </div>
          </a>
        
        
          <a href="../socless-and-serverless/" title="Socless & Serverless" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Socless & Serverless
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>